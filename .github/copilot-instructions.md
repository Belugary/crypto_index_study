# 区块链资产指数研究项目开发指南

## 核心原则

### 1. 简单胜于复杂

- 优先选择最直接的解决方案
- 避免过度工程化和复杂的抽象
- 代码清晰胜过聪明

### 2. 用户导向

- 功能设计围绕用户实际需求
- 用户参数表达期望结果，系统负责实现
- 避免暴露技术细节给用户

### 3. 信任权威数据源

- 优先使用 CoinGecko 官方分类
- 自定义逻辑只作为补充，不替代权威源

## 技术规范

### 代码

- Python + CoinGecko API
- 中文注释，清晰的类型提示
- 测试覆盖核心功能

### 文档

- 朴实无华，避免营销化语言
- 聚焦用户使用方法，而非技术实现
- 保持简洁，突出核心价值

### 数据

- 默认 510 个原生币，可配置
- 自动过滤稳定币和包装币
- 数据更新日期格式：(最近更新: YYYY-MM-DD)

### 项目结构

- `src/` 核心代码
- `scripts/` 用户脚本（薄封装）
- `tests/` 测试用例
- `data/` 数据资产
- `logs/` 日志文件

## 质量保证

- 所有测试必须通过
- 重构后立即运行测试
- 配置变更检查相关文件一致性
- Git 提交信息清晰，按功能分批提交

---

## 附录：常见问题与解决方案

### 数据源架构要点

- 指数计算使用 `data/daily/daily_files/` 每日汇总数据
- 通过 `DailyDataAggregator` 统一数据访问
- CSV 文件包含表头，使用 `pd.read_csv()` 而非 `header=None`

### 常见错误模式

**时间戳转换错误**:

```
ValueError: could not convert string to float: 'timestamp'
```

- 原因：CSV 包含表头，直接转换失败
- 解决：使用 `DailyDataAggregator` 或正确处理表头

**分类器字段不匹配**:

- 检查返回字段名（如 `is_wrapped_coin` vs `is_wrapped`）
- 确保分类器覆盖所有衍生品类型
- 避免过宽的异常处理

### 测试管理

- 重构后必须运行 `python -m pytest tests/ -v`
- 更新测试文件中的过时 import 路径
- 保持 100%测试通过率

---

**记住：当指南本身变得复杂时，说明偏离了核心原则。简单有效胜过复杂完美。**
